# Generated by Django 4.2.27 on 2026-01-16 12:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Badge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(help_text='ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•˜ëŠ” ê³ ìœ  ì½”ë“œ', max_length=50, unique=True, verbose_name='ì½”ë“œ')),
                ('name', models.CharField(max_length=100, verbose_name='ë±ƒì§€ ì´ë¦„')),
                ('description', models.TextField(blank=True, verbose_name='ì„¤ëª…')),
                ('icon', models.CharField(default='ğŸ†', max_length=50, verbose_name='ì•„ì´ì½˜')),
                ('category', models.CharField(choices=[('speed', 'ì†ë„'), ('accuracy', 'ì •í™•ë„'), ('streak', 'ì—°ì†ì¼'), ('challenge', 'ì±Œë¦°ì§€'), ('milestone', 'ë§ˆì¼ìŠ¤í†¤'), ('special', 'íŠ¹ë³„')], default='milestone', max_length=20, verbose_name='ì¹´í…Œê³ ë¦¬')),
                ('rarity', models.PositiveSmallIntegerField(choices=[(1, 'ì¼ë°˜'), (2, 'í¬ê·€'), (3, 'ì˜ì›…'), (4, 'ì „ì„¤')], default=1, verbose_name='í¬ê·€ë„')),
                ('condition_type', models.CharField(blank=True, help_text='wpm_reach, accuracy_reach, streak_reach, sessions_complete ë“±', max_length=50, verbose_name='ì¡°ê±´ ìœ í˜•')),
                ('condition_value', models.PositiveIntegerField(blank=True, null=True, verbose_name='ì¡°ê±´ ê°’')),
                ('reward_points', models.PositiveIntegerField(default=50, verbose_name='ë³´ìƒ í¬ì¸íŠ¸')),
                ('is_active', models.BooleanField(default=True, verbose_name='í™œì„±í™”')),
                ('is_secret', models.BooleanField(default=False, help_text='íšë“ ì „ê¹Œì§€ ìˆ¨ê¹€', verbose_name='ì‹œí¬ë¦¿ ë±ƒì§€')),
                ('order', models.PositiveIntegerField(default=0, verbose_name='ì •ë ¬ ìˆœì„œ')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='ìƒì„±ì¼')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='ìˆ˜ì •ì¼')),
            ],
            options={
                'verbose_name': 'ë±ƒì§€',
                'verbose_name_plural': 'ë±ƒì§€ë“¤',
                'ordering': ['order', 'category', 'rarity'],
            },
        ),
        migrations.CreateModel(
            name='UserLevel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('level', models.PositiveIntegerField(default=1, verbose_name='ë ˆë²¨')),
                ('experience', models.PositiveIntegerField(default=0, verbose_name='ê²½í—˜ì¹˜')),
                ('total_points', models.PositiveIntegerField(default=0, verbose_name='ì´ í¬ì¸íŠ¸')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='ìƒì„±ì¼')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='ìˆ˜ì •ì¼')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='level', to=settings.AUTH_USER_MODEL, verbose_name='ì‚¬ìš©ì')),
            ],
            options={
                'verbose_name': 'ì‚¬ìš©ì ë ˆë²¨',
                'verbose_name_plural': 'ì‚¬ìš©ì ë ˆë²¨ë“¤',
            },
        ),
        migrations.CreateModel(
            name='UserBadge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('earned_at', models.DateTimeField(auto_now_add=True, verbose_name='íšë“ ì‹œê°')),
                ('is_featured', models.BooleanField(default=False, help_text='í”„ë¡œí•„ì— í‘œì‹œí•  ëŒ€í‘œ ë±ƒì§€', verbose_name='ëŒ€í‘œ ë±ƒì§€')),
                ('badge', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='owners', to='achievements.badge', verbose_name='ë±ƒì§€')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='badges', to=settings.AUTH_USER_MODEL, verbose_name='ì‚¬ìš©ì')),
            ],
            options={
                'verbose_name': 'ì‚¬ìš©ì ë±ƒì§€',
                'verbose_name_plural': 'ì‚¬ìš©ì ë±ƒì§€ë“¤',
                'ordering': ['-earned_at'],
            },
        ),
        migrations.AddIndex(
            model_name='badge',
            index=models.Index(fields=['category', 'is_active'], name='idx_badge_category'),
        ),
        migrations.AddIndex(
            model_name='badge',
            index=models.Index(fields=['condition_type'], name='idx_badge_condition'),
        ),
        migrations.AddIndex(
            model_name='userbadge',
            index=models.Index(fields=['user', '-earned_at'], name='idx_ub_user_earned'),
        ),
        migrations.AddConstraint(
            model_name='userbadge',
            constraint=models.UniqueConstraint(fields=('user', 'badge'), name='uq_user_badge'),
        ),
    ]
